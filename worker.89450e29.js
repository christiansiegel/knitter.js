parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"JZPE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.expose=c,exports.proxy=v,exports.transfer=h,exports.windowEndpoint=x,exports.wrap=l,exports.transferHandlers=exports.releaseProxy=exports.proxyMarker=exports.createEndpoint=void 0;const e=Symbol("Comlink.proxy");exports.proxyMarker=e;const t=Symbol("Comlink.endpoint");exports.createEndpoint=t;const n=Symbol("Comlink.releaseProxy");exports.releaseProxy=n;const r=Symbol("Comlink.thrown"),a=e=>"object"==typeof e&&null!==e||"function"==typeof e,s={canHandle:t=>a(t)&&t[e],serialize(e){const{port1:t,port2:n}=new MessageChannel;return c(e,t),[n,[n]]},deserialize:e=>(e.start(),l(e))},o={canHandle:e=>a(e)&&r in e,serialize({value:e}){let t;return[t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}},i=new Map([["proxy",s],["throw",o]]);function c(e,t=self){t.addEventListener("message",function n(a){if(!a||!a.data)return;const{id:s,type:o,path:i}=Object.assign({path:[]},a.data),p=(a.data.argumentList||[]).map(w);let l;try{const t=i.slice(0,-1).reduce((e,t)=>e[t],e),n=i.reduce((e,t)=>e[t],e);switch(o){case 0:l=n;break;case 1:t[i.slice(-1)[0]]=w(a.data.value),l=!0;break;case 2:l=n.apply(t,p);break;case 3:l=v(new n(...p));break;case 4:{const{port1:t,port2:n}=new MessageChannel;c(e,n),l=h(t,[t])}break;case 5:l=void 0}}catch(d){l={value:d,[r]:0}}Promise.resolve(l).catch(e=>({value:e,[r]:0})).then(e=>{const[r,a]=b(e);t.postMessage(Object.assign(Object.assign({},r),{id:s}),a),5===o&&(t.removeEventListener("message",n),u(t))})}),t.start&&t.start()}function p(e){return"MessagePort"===e.constructor.name}function u(e){p(e)&&e.close()}function l(e,t){return f(e,[],t)}function d(e){if(e)throw new Error("Proxy has been released and is not useable")}function f(e,r=[],a=function(){}){let s=!1;const o=new Proxy(a,{get(t,a){if(d(s),a===n)return()=>E(e,{type:5,path:r.map(e=>e.toString())}).then(()=>{u(e),s=!0});if("then"===a){if(0===r.length)return{then:()=>o};const t=E(e,{type:0,path:r.map(e=>e.toString())}).then(w);return t.then.bind(t)}return f(e,[...r,a])},set(t,n,a){d(s);const[o,i]=b(a);return E(e,{type:1,path:[...r,n].map(e=>e.toString()),value:o},i).then(w)},apply(n,a,o){d(s);const i=r[r.length-1];if(i===t)return E(e,{type:4}).then(w);if("bind"===i)return f(e,r.slice(0,-1));const[c,p]=g(o);return E(e,{type:2,path:r.map(e=>e.toString()),argumentList:c},p).then(w)},construct(t,n){d(s);const[a,o]=g(n);return E(e,{type:3,path:r.map(e=>e.toString()),argumentList:a},o).then(w)}});return o}function m(e){return Array.prototype.concat.apply([],e)}function g(e){const t=e.map(b);return[t.map(e=>e[0]),m(t.map(e=>e[1]))]}exports.transferHandlers=i;const y=new WeakMap;function h(e,t){return y.set(e,t),e}function v(t){return Object.assign(t,{[e]:!0})}function x(e,t=self,n="*"){return{postMessage:(t,r)=>e.postMessage(t,n,r),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function b(e){for(const[t,n]of i)if(n.canHandle(e)){const[r,a]=n.serialize(e);return[{type:3,name:t,value:r},a]}return[{type:0,value:e},y.get(e)||[]]}function w(e){switch(e.type){case 3:return i.get(e.name).deserialize(e.value);case 0:return e.value}}function E(e,t,n){return new Promise(r=>{const a=M();e.addEventListener("message",function t(n){n.data&&n.data.id&&n.data.id===a&&(e.removeEventListener("message",t),r(n.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),n)})}function M(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}
},{}],"kRPb":[function(require,module,exports) {
"use strict";function t(t){let n=-1/0,e=-1;for(const[r,o]of t.entries())o>n&&(e=r,n=o);return e}function n(t,n){return 255-n.reduce((n,e)=>n+t[e],0)/n.length}function e(t,n,e){n.forEach(n=>t[n]=Math.min(255,t[n]+e))}function r(t,n,e){const r=Math.abs(t-n);return Math.min(e-r,r)}function o(t,n){return t.id<n.id?1024*t.id+n.id:1024*n.id+t.id}function i(t,n,e){(t.y>n.y||t.y===n.y&&t.x>n.x)&&([t,n]=[n,t]);const r=Math.abs(n.x-t.x),o=-Math.abs(n.y-t.y),i=t.x<n.x?1:-1,h=t.y<n.y?1:-1,s=[],a=Object.assign({},t);let u,c=r+o;for(;s.push(a.y*e+a.x),a.x!=n.x||a.y!=n.y;)(u=2*c)>o&&(c+=o,a.x+=i),u<r&&(c+=r,a.y+=h);return s}function h(t,n,e){const r=Math.min(n.width,n.height),o=Math.round((n.width-r)/2),i=Math.round((n.height-r)/2);return("circle"===e?s:a)(t,r).map(t=>Object.assign(Object.assign({},t),{x:t.x+o,y:t.y+i}))}function s(t,n){const e=Math.floor((n-1)/2),r=2*Math.PI/t,o=[];for(let i=0;i<t;i++)o.push({id:i,x:Math.round(e+e*Math.sin(i*r)),y:Math.round(e+e*Math.cos(Math.PI+i*r))});return o}function a(t,n){const e=Math.floor(t/4),r=(n-1)/e,o=[];for(let i=0;i<e;i++)o.push({id:o.length,x:Math.round(r*i),y:0});for(let i=0;i<e;i++)o.push({id:o.length,x:n-1,y:Math.round(r*i)});for(let i=0;i<e;i++)o.push({id:o.length,x:n-1-Math.round(r*i),y:n-1});for(let i=0;i<e;i++)o.push({id:o.length,x:0,y:n-1-Math.round(r*i)});return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.indexOfMax=t,exports.calcScore=n,exports.lightenUp=e,exports.circularArrayIndexDistance=r,exports.makePinPairId=o,exports.getLineIndices=i,exports.calcPins=h;
},{}],"S4O0":[function(require,module,exports) {
"use strict";function e(e,t){const r=(t=t||{}).keyFn||function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return JSON.stringify(t)};if(void 0===t.cacheSize){const t={};return function(){const n=r(...arguments);if(n in t)return t[n];const c=e(...arguments);return t[n]=c,c}}if(t.cacheSize<=0)return e;if(1===t.cacheSize){let t,n;return function(){const c=r(...arguments);return c===t?n:(t=c,n=e(...arguments))}}throw Error("Cache size ".concat(t.cacheSize," not supported yet!"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.cachify=e;
},{}],"QpEN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Core=void 0;var i=require("./algorithms"),t=require("./cachify");const e=(0,t.cachify)((e,n,s)=>({pins:(0,i.calcPins)(e,n,s),getLineIndices:(0,t.cachify)(i.getLineIndices,{keyFn:i.makePinPairId})}),{cacheSize:1});class n{constructor(){this.params=void 0,this.usedPinPairIds={}}init(i){this.loom=e(i.numberOfPins,i.dimensions,i.shape),this.usedPinPairIds={},this.pattern=[0],this.params=i}getPins(){if(!this.loom)throw new Error("Core not initialized");return this.loom.pins}getPattern(){if(!this.pattern)throw new Error("Core not initialized");return this.pattern}calcPattern(t){if(!this.pattern||!this.loom||!this.params)throw new Error("Core not initialized");const e=this.loom,n=e.pins,s=this.params;for(let r=this.pattern.length;r<t;++r){const t=n[this.pattern[this.pattern.length-1]],r=e=>!((0,i.makePinPairId)(t,e)in this.usedPinPairIds),a=e=>(0,i.circularArrayIndexDistance)(t.id,e.id,n.length)>=s.minimalDistance,o=n=>{const r=e.getLineIndices(t,n,s.dimensions.width);return(0,i.calcScore)(s.pixels,r)};let h=n.filter(r);if(0===(h=h.filter(a)).length)return this.pattern;const c=h.map(o),d=h[(0,i.indexOfMax)(c)];void 0===d&&console.log(h);const l=e.getLineIndices(t,d,s.dimensions.width);(0,i.lightenUp)(s.pixels,l,Math.round(255*s.fadeRate/100)),this.usedPinPairIds[(0,i.makePinPairId)(t,d)]=!0,this.pattern.push(d.id)}return this.pattern.slice(0,t)}}exports.Core=n;
},{"./algorithms":"kRPb","./cachify":"S4O0"}],"ZXZ8":[function(require,module,exports) {
"use strict";var e=require("comlink"),r=require("./core");(0,e.expose)(r.Core);
},{"comlink":"JZPE","./core":"QpEN"}]},{},["ZXZ8"], null)